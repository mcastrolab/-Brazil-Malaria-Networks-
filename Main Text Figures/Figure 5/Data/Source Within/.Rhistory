sib14,
sib15,
sib16,
sib17,
sib18,
sib19,
sib20,
sib21,
sib22)
sib <- sib[sib$P_VALUE<0.05,]
sib_m_04 <- read_sf("sinkbtw2004.col.shp")
sib_m_05 <- read_sf("sinkbtw2005.col.shp")
sib_m_06 <- read_sf("sinkbtw2006.col.shp")
sib_m_07 <- read_sf("sinkbtw2007.col.shp")
sib_m_08 <- read_sf("sinkbtw2008.col.shp")
sib_m_09 <- read_sf("sinkbtw2009.col.shp")
sib_m_10 <- read_sf("sinkbtw2010.col.shp")
sib_m_11 <- read_sf("sinkbtw2011.col.shp")
sib_m_12 <- read_sf("sinkbtw2012.col.shp")
sib_m_13 <- read_sf("sinkbtw2013.col.shp")
sib_m_14 <- read_sf("sinkbtw2014.col.shp")
sib_m_15 <- read_sf("sinkbtw2015.col.shp")
sib_m_16 <- read_sf("sinkbtw2016.col.shp")
sib_m_17 <- read_sf("sinkbtw2017.col.shp")
sib_m_18 <- read_sf("sinkbtw2018.col.shp")
sib_m_19 <- read_sf("sinkbtw2019.col.shp")
sib_m_20 <- read_sf("sinkbtw2020.col.shp")
sib_m_21 <- read_sf("sinkbtw2021.col.shp")
sib_m_22 <- read_sf("sinkbtw2022.col.shp")
sib_m_04$year <- 2004
sib_m_05$year <- 2005
sib_m_06$year <- 2006
sib_m_07$year <- 2007
sib_m_08$year <- 2008
sib_m_09$year <- 2009
sib_m_10$year <- 2010
sib_m_11$year <- 2011
sib_m_12$year <- 2012
sib_m_13$year <- 2013
sib_m_14$year <- 2014
sib_m_15$year <- 2015
sib_m_16$year <- 2016
sib_m_17$year <- 2017
sib_m_18$year <- 2018
sib_m_19$year <- 2019
sib_m_20$year <- 2020
sib_m_21$year <- 2021
sib_m_22$year <- 2022
sib_m <- rbind(sib_m_04,
sib_m_05,
sib_m_06,
sib_m_07,
sib_m_08,
sib_m_09,
sib_m_10,
sib_m_11,
sib_m_12,
sib_m_13,
sib_m_14,
sib_m_15,
sib_m_16,
sib_m_17,
sib_m_18,
sib_m_19,
sib_m_20,
sib_m_21,
sib_m_22)
sib_m <- sib_m[sib_m$P_VALUE<0.05,]
sib_m$END_DATE <- as.Date(sib_m$END_DATE)
sib_m$START_DATE <- as.Date(sib_m$START_DATE)
sib_m$months <- interval(sib_m$START_DATE, sib_m$END_DATE) %/% months(1)
sib_m$year_grp <- NA
sib_m$year_grp[sib_m$year%in%c(2004:2009)] <- 1
sib_m$year_grp[sib_m$year%in%c(2010:2016)] <- 2
sib_m$year_grp[sib_m$year%in%c(2017:2022)] <- 3
sib_m <- as.data.frame(sib_m)
sib <- as.data.frame(sib)
sib_final <- merge(subset(sib,select=c("LOC_ID","year","CLUSTER")),
subset(sib_m,select=c("LOC_ID","year","year_grp","months","CLUSTER")),
by=c("year","CLUSTER"),all=T)
sib_final$LOC_ID.y <- NULL
names(sib_final)[3] <- "mun"
sib_grp <- sib_final %>%
group_by(year_grp,mun) %>%
summarise(total_months = sum(months))
sib_grp$perc_sig <- NA
sib_grp$perc_sig[sib_grp$year_grp==1] <- sib_grp$total_months[sib_grp$year_grp==1]/72
sib_grp$perc_sig[sib_grp$year_grp==2] <- sib_grp$total_months[sib_grp$year_grp==2]/72
sib_grp$perc_sig[sib_grp$year_grp==3] <- sib_grp$total_months[sib_grp$year_grp==3]/72
sib_grp$type <- "sink_between"
### SINK WITHIN ###
setwd("C:/Users/nicho/OneDrive/Dissertation/Chapter I/Mobility paper/Current analyses/SatScan/CURRENT -- SatScan -- 04 to 2022 with SINAN/Output/Sink within")
siw04 <- read_sf("sinkwtn2004.gis.shp")
siw05 <- read_sf("sinkwtn2005.gis.shp")
siw06 <- read_sf("sinkwtn2006.gis.shp")
siw07 <- read_sf("sinkwtn2007.gis.shp")
siw08 <- read_sf("sinkwtn2008.gis.shp")
siw09 <- read_sf("sinkwtn2009.gis.shp")
siw10 <- read_sf("sinkwtn2010.gis.shp")
siw11 <- read_sf("sinkwtn2011.gis.shp")
siw12 <- read_sf("sinkwtn2012.gis.shp")
siw13 <- read_sf("sinkwtn2013.gis.shp")
siw14 <- read_sf("sinkwtn2014.gis.shp")
siw15 <- read_sf("sinkwtn2015.gis.shp")
siw16 <- read_sf("sinkwtn2016.gis.shp")
siw17 <- read_sf("sinkwtn2017.gis.shp")
siw18 <- read_sf("sinkwtn2018.gis.shp")
siw19 <- read_sf("sinkwtn2019.gis.shp")
siw20 <- read_sf("sinkwtn2020.gis.shp")
siw21 <- read_sf("sinkwtn2021.gis.shp")
siw22 <- read_sf("sinkwtn2022.gis.shp")
siw04$year <- 2004
siw05$year <- 2005
siw06$year <- 2006
siw07$year <- 2007
siw08$year <- 2008
siw09$year <- 2009
siw10$year <- 2010
siw11$year <- 2011
siw12$year <- 2012
siw13$year <- 2013
siw14$year <- 2014
siw15$year <- 2015
siw16$year <- 2016
siw17$year <- 2017
siw18$year <- 2018
siw19$year <- 2019
siw20$year <- 2020
siw21$year <- 2021
siw22$year <- 2022
siw <- rbind(siw04,
siw05,
siw06,
siw07,
siw08,
siw09,
siw10,
siw11,
siw12,
siw13,
siw14,
siw15,
siw16,
siw17,
siw18,
siw19,
siw20,
siw21,
siw22)
siw <- siw[siw$P_VALUE<0.05,]
siw_m_04 <- read_sf("sinkwtn2004.col.shp")
siw_m_05 <- read_sf("sinkwtn2005.col.shp")
siw_m_06 <- read_sf("sinkwtn2006.col.shp")
siw_m_07 <- read_sf("sinkwtn2007.col.shp")
siw_m_08 <- read_sf("sinkwtn2008.col.shp")
siw_m_09 <- read_sf("sinkwtn2009.col.shp")
siw_m_10 <- read_sf("sinkwtn2010.col.shp")
siw_m_11 <- read_sf("sinkwtn2011.col.shp")
siw_m_12 <- read_sf("sinkwtn2012.col.shp")
siw_m_13 <- read_sf("sinkwtn2013.col.shp")
siw_m_14 <- read_sf("sinkwtn2014.col.shp")
siw_m_15 <- read_sf("sinkwtn2015.col.shp")
siw_m_16 <- read_sf("sinkwtn2016.col.shp")
siw_m_17 <- read_sf("sinkwtn2017.col.shp")
siw_m_18 <- read_sf("sinkwtn2018.col.shp")
siw_m_19 <- read_sf("sinkwtn2019.col.shp")
siw_m_20 <- read_sf("sinkwtn2020.col.shp")
siw_m_21 <- read_sf("sinkwtn2021.col.shp")
siw_m_22 <- read_sf("sinkwtn2022.col.shp")
siw_m_04$year <- 2004
siw_m_05$year <- 2005
siw_m_06$year <- 2006
siw_m_07$year <- 2007
siw_m_08$year <- 2008
siw_m_09$year <- 2009
siw_m_10$year <- 2010
siw_m_11$year <- 2011
siw_m_12$year <- 2012
siw_m_13$year <- 2013
siw_m_14$year <- 2014
siw_m_15$year <- 2015
siw_m_16$year <- 2016
siw_m_17$year <- 2017
siw_m_18$year <- 2018
siw_m_19$year <- 2019
siw_m_20$year <- 2020
siw_m_21$year <- 2021
siw_m_22$year <- 2022
siw_m <- rbind(siw_m_04,
siw_m_05,
siw_m_06,
siw_m_07,
siw_m_08,
siw_m_09,
siw_m_10,
siw_m_11,
siw_m_12,
siw_m_13,
siw_m_14,
siw_m_15,
siw_m_16,
siw_m_17,
siw_m_18,
siw_m_19,
siw_m_20,
siw_m_21,
siw_m_22)
siw_m <- siw_m[siw_m$P_VALUE<0.05,]
siw_m$END_DATE <- as.Date(siw_m$END_DATE)
siw_m$START_DATE <- as.Date(siw_m$START_DATE)
siw_m$months <- interval(siw_m$START_DATE, siw_m$END_DATE) %/% months(1)
siw_m$year_grp <- NA
siw_m$year_grp[siw_m$year%in%c(2004:2009)] <- 1
siw_m$year_grp[siw_m$year%in%c(2010:2016)] <- 2
siw_m$year_grp[siw_m$year%in%c(2017:2022)] <- 3
siw_m <- as.data.frame(siw_m)
siw <- as.data.frame(siw)
siw_final <- merge(subset(siw,select=c("LOC_ID","year","CLUSTER")),
subset(siw_m,select=c("LOC_ID","year","year_grp","months","CLUSTER")),
by=c("year","CLUSTER"),all=T)
siw_final$LOC_ID.y <- NULL
names(siw_final)[3] <- "mun"
siw_grp <- siw_final %>%
group_by(year_grp,mun) %>%
summarise(total_months = sum(months))
siw_grp$perc_sig <- NA
siw_grp$perc_sig[siw_grp$year_grp==1] <- siw_grp$total_months[siw_grp$year_grp==1]/72
siw_grp$perc_sig[siw_grp$year_grp==2] <- siw_grp$total_months[siw_grp$year_grp==2]/72
siw_grp$perc_sig[siw_grp$year_grp==3] <- siw_grp$total_months[siw_grp$year_grp==3]/72
siw_grp$type <- "sink_within"
### SOURCE BETWEEN ###
setwd("C:/Users/nicho/OneDrive/Dissertation/Chapter I/Mobility paper/Current analyses/SatScan/CURRENT -- SatScan -- 04 to 2022 with SINAN/Output/Source between")
sob04 <- read_sf("sourcebtw2004.gis.shp")
sob05 <- read_sf("sourcebtw2005.gis.shp")
sob06 <- read_sf("sourcebtw2006.gis.shp")
sob07 <- read_sf("sourcebtw2007.gis.shp")
sob08 <- read_sf("sourcebtw2008.gis.shp")
sob09 <- read_sf("sourcebtw2009.gis.shp")
sob10 <- read_sf("sourcebtw2010.gis.shp")
sob11 <- read_sf("sourcebtw2011.gis.shp")
sob12 <- read_sf("sourcebtw2012.gis.shp")
sob13 <- read_sf("sourcebtw2013.gis.shp")
sob14 <- read_sf("sourcebtw2014.gis.shp")
sob15 <- read_sf("sourcebtw2015.gis.shp")
sob16 <- read_sf("sourcebtw2016.gis.shp")
sob17 <- read_sf("sourcebtw2017.gis.shp")
sob18 <- read_sf("sourcebtw2018.gis.shp")
sob19 <- read_sf("sourcebtw2019.gis.shp")
sob20 <- read_sf("sourcebtw2020.gis.shp")
sob21 <- read_sf("sourcebtw2021.gis.shp")
sob22 <- read_sf("sourcebtw2022.gis.shp")
sob04$year <- 2004
sob05$year <- 2005
sob06$year <- 2006
sob07$year <- 2007
sob08$year <- 2008
sob09$year <- 2009
sob10$year <- 2010
sob11$year <- 2011
sob12$year <- 2012
sob13$year <- 2013
sob14$year <- 2014
sob15$year <- 2015
sob16$year <- 2016
sob17$year <- 2017
sob18$year <- 2018
sob19$year <- 2019
sob20$year <- 2020
sob21$year <- 2021
sob22$year <- 2022
sob <- rbind(sob04,
sob05,
sob06,
sob07,
sob08,
sob09,
sob10,
sob11,
sob12,
sob13,
sob14,
sob15,
sob16,
sob17,
sob18,
sob19,
sob20,
sob21,
sob22)
sob <- sob[sob$P_VALUE<0.05,]
sob_m_04 <- read_sf("sourcebtw2004.col.shp")
sob_m_05 <- read_sf("sourcebtw2005.col.shp")
sob_m_06 <- read_sf("sourcebtw2006.col.shp")
sob_m_07 <- read_sf("sourcebtw2007.col.shp")
sob_m_08 <- read_sf("sourcebtw2008.col.shp")
sob_m_09 <- read_sf("sourcebtw2009.col.shp")
sob_m_10 <- read_sf("sourcebtw2010.col.shp")
sob_m_11 <- read_sf("sourcebtw2011.col.shp")
sob_m_12 <- read_sf("sourcebtw2012.col.shp")
sob_m_13 <- read_sf("sourcebtw2013.col.shp")
sob_m_14 <- read_sf("sourcebtw2014.col.shp")
sob_m_15 <- read_sf("sourcebtw2015.col.shp")
sob_m_16 <- read_sf("sourcebtw2016.col.shp")
sob_m_17 <- read_sf("sourcebtw2017.col.shp")
sob_m_18 <- read_sf("sourcebtw2018.col.shp")
sob_m_19 <- read_sf("sourcebtw2019.col.shp")
sob_m_20 <- read_sf("sourcebtw2020.col.shp")
sob_m_21 <- read_sf("sourcebtw2021.col.shp")
sob_m_22 <- read_sf("sourcebtw2022.col.shp")
sob_m_04$year <- 2004
sob_m_05$year <- 2005
sob_m_06$year <- 2006
sob_m_07$year <- 2007
sob_m_08$year <- 2008
sob_m_09$year <- 2009
sob_m_10$year <- 2010
sob_m_11$year <- 2011
sob_m_12$year <- 2012
sob_m_13$year <- 2013
sob_m_14$year <- 2014
sob_m_15$year <- 2015
sob_m_16$year <- 2016
sob_m_17$year <- 2017
sob_m_18$year <- 2018
sob_m_19$year <- 2019
sob_m_20$year <- 2020
sob_m_21$year <- 2021
sob_m_22$year <- 2022
sob_m <- rbind(sob_m_04,
sob_m_05,
sob_m_06,
sob_m_07,
sob_m_08,
sob_m_09,
sob_m_10,
sob_m_11,
sob_m_12,
sob_m_13,
sob_m_14,
sob_m_15,
sob_m_16,
sob_m_17,
sob_m_18,
sob_m_19,
sob_m_20,
sob_m_21,
sob_m_22)
sob_m <- sob_m[sob_m$P_VALUE<0.05,]
sob_m$END_DATE <- as.Date(sob_m$END_DATE)
sob_m$START_DATE <- as.Date(sob_m$START_DATE)
sob_m$months <- interval(sob_m$START_DATE, sob_m$END_DATE) %/% months(1)
sob_m$year_grp <- NA
sob_m$year_grp[sob_m$year%in%c(2004:2009)] <- 1
sob_m$year_grp[sob_m$year%in%c(2010:2016)] <- 2
sob_m$year_grp[sob_m$year%in%c(2017:2022)] <- 3
sob_m <- as.data.frame(sob_m)
sob <- as.data.frame(sob)
sob_final <- merge(subset(sob,select=c("LOC_ID","year","CLUSTER")),
subset(sob_m,select=c("LOC_ID","year","year_grp","months","CLUSTER")),
by=c("year","CLUSTER"),all=T)
sob_final$LOC_ID.y <- NULL
names(sob_final)[3] <- "mun"
sob_grp <- sob_final %>%
group_by(year_grp,mun) %>%
summarise(total_months = sum(months))
sob_grp$perc_sig <- NA
sob_grp$perc_sig[sob_grp$year_grp==1] <- sob_grp$total_months[sob_grp$year_grp==1]/72
sob_grp$perc_sig[sob_grp$year_grp==2] <- sob_grp$total_months[sob_grp$year_grp==2]/72
sob_grp$perc_sig[sob_grp$year_grp==3] <- sob_grp$total_months[sob_grp$year_grp==3]/72
sob_grp$type <- "source_between"
### SOURCE WITHIN ###
setwd("C:/Users/nicho/OneDrive/Dissertation/Chapter I/Mobility paper/Current analyses/SatScan/CURRENT -- SatScan -- 04 to 2022 with SINAN/Output/Source within")
sow04 <- read_sf("sourcewtn2004.gis.shp")
sow05 <- read_sf("sourcewtn2005.gis.shp")
sow06 <- read_sf("sourcewtn2006.gis.shp")
sow07 <- read_sf("sourcewtn2007.gis.shp")
sow08 <- read_sf("sourcewtn2008.gis.shp")
sow09 <- read_sf("sourcewtn2009.gis.shp")
sow10 <- read_sf("sourcewtn2010.gis.shp")
sow11 <- read_sf("sourcewtn2011.gis.shp")
sow12 <- read_sf("sourcewtn2012.gis.shp")
sow13 <- read_sf("sourcewtn2013.gis.shp")
sow14 <- read_sf("sourcewtn2014.gis.shp")
sow15 <- read_sf("sourcewtn2015.gis.shp")
sow16 <- read_sf("sourcewtn2016.gis.shp")
sow17 <- read_sf("sourcewtn2017.gis.shp")
sow18 <- read_sf("sourcewtn2018.gis.shp")
sow19 <- read_sf("sourcewtn2019.gis.shp")
sow20 <- read_sf("sourcewtn2020.gis.shp")
sow21 <- read_sf("sourcewtn2021.gis.shp")
sow22 <- read_sf("sourcewtn2022.gis.shp")
sow04$year <- 2004
sow05$year <- 2005
sow06$year <- 2006
sow07$year <- 2007
sow08$year <- 2008
sow09$year <- 2009
sow10$year <- 2010
sow11$year <- 2011
sow12$year <- 2012
sow13$year <- 2013
sow14$year <- 2014
sow15$year <- 2015
sow16$year <- 2016
sow17$year <- 2017
sow18$year <- 2018
sow19$year <- 2019
sow20$year <- 2020
sow21$year <- 2021
sow22$year <- 2022
sow <- rbind(sow04,
sow05,
sow06,
sow07,
sow08,
sow09,
sow10,
sow11,
sow12,
sow13,
sow14,
sow15,
sow16,
sow17,
sow18,
sow19,
sow20,
sow21,
sow22)
sow <- sow[sow$P_VALUE<0.05,]
sow_m_04 <- read_sf("sourcewtn2004.col.shp")
sow_m_05 <- read_sf("sourcewtn2005.col.shp")
sow_m_06 <- read_sf("sourcewtn2006.col.shp")
sow_m_07 <- read_sf("sourcewtn2007.col.shp")
sow_m_08 <- read_sf("sourcewtn2008.col.shp")
sow_m_09 <- read_sf("sourcewtn2009.col.shp")
sow_m_10 <- read_sf("sourcewtn2010.col.shp")
sow_m_11 <- read_sf("sourcewtn2011.col.shp")
sow_m_12 <- read_sf("sourcewtn2012.col.shp")
sow_m_13 <- read_sf("sourcewtn2013.col.shp")
sow_m_14 <- read_sf("sourcewtn2014.col.shp")
sow_m_15 <- read_sf("sourcewtn2015.col.shp")
sow_m_16 <- read_sf("sourcewtn2016.col.shp")
sow_m_17 <- read_sf("sourcewtn2017.col.shp")
sow_m_18 <- read_sf("sourcewtn2018.col.shp")
sow_m_19 <- read_sf("sourcewtn2019.col.shp")
sow_m_20 <- read_sf("sourcewtn2020.col.shp")
sow_m_21 <- read_sf("sourcewtn2021.col.shp")
sow_m_22 <- read_sf("sourcewtn2022.col.shp")
sow_m_04$year <- 2004
sow_m_05$year <- 2005
sow_m_06$year <- 2006
sow_m_07$year <- 2007
sow_m_08$year <- 2008
sow_m_09$year <- 2009
sow_m_10$year <- 2010
sow_m_11$year <- 2011
sow_m_12$year <- 2012
sow_m_13$year <- 2013
sow_m_14$year <- 2014
sow_m_15$year <- 2015
sow_m_16$year <- 2016
sow_m_17$year <- 2017
sow_m_18$year <- 2018
sow_m_19$year <- 2019
sow_m_20$year <- 2020
sow_m_21$year <- 2021
sow_m_22$year <- 2022
sow_m <- rbind(sow_m_04,
sow_m_05,
sow_m_06,
sow_m_07,
sow_m_08,
sow_m_09,
sow_m_10,
sow_m_11,
sow_m_12,
sow_m_13,
sow_m_14,
sow_m_15,
sow_m_16,
sow_m_17,
sow_m_18,
sow_m_19,
sow_m_20,
sow_m_21,
sow_m_22)
sow_m <- sow_m[sow_m$P_VALUE<0.05,]
sow_m$END_DATE <- as.Date(sow_m$END_DATE)
sow_m$START_DATE <- as.Date(sow_m$START_DATE)
sow_m$months <- interval(sow_m$START_DATE, sow_m$END_DATE) %/% months(1)
sow_m$year_grp <- NA
sow_m$year_grp[sow_m$year%in%c(2004:2009)] <- 1
sow_m$year_grp[sow_m$year%in%c(2010:2016)] <- 2
sow_m$year_grp[sow_m$year%in%c(2017:2022)] <- 3
sow_m <- as.data.frame(sow_m)
sow <- as.data.frame(sow)
sow_final <- merge(subset(sow,select=c("LOC_ID","year","CLUSTER")),
subset(sow_m,select=c("LOC_ID","year","year_grp","months","CLUSTER")),
by=c("year","CLUSTER"),all=T)
sow_final$LOC_ID.y <- NULL
names(sow_final)[3] <- "mun"
sow_grp <- sow_final %>%
group_by(year_grp,mun) %>%
summarise(total_months = sum(months))
sow_grp$perc_sig <- NA
sow_grp$perc_sig[sow_grp$year_grp==1] <- sow_grp$total_months[sow_grp$year_grp==1]/72
sow_grp$perc_sig[sow_grp$year_grp==2] <- sow_grp$total_months[sow_grp$year_grp==2]/72
sow_grp$perc_sig[sow_grp$year_grp==3] <- sow_grp$total_months[sow_grp$year_grp==3]/72
sow_grp$type <- "source_within"
sources_sinks_merge <- rbind(siw_grp,sow_grp,sib_grp,sob_grp)
write.csv(sources_sinks_merge,"C:/Users/nicho/OneDrive/Dissertation/Chapter I/Mobility paper/Current analyses/Figures/Figure 5/source and sink cluster data for maps.csv")
